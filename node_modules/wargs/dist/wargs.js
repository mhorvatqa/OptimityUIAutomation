"use strict";const EMPTYARR=[],SHORTSPLIT=/$|[!-@[-`{-~][\s\S]*/g,isArray=Array.isArray,parseValue=function(e){if(""===e)return"";if("false"===e)return!1;const a=Number(e);return 0*a==0?a:e},parseAlias=function(e){let a,t,r,s,i,n,o,l={};for(a in e)for(i=e[a],t=l[a]=isArray(i)?i:[i],n=0,s=t.length;n<s;n++)for(r=l[t[n]]=[a],o=0;o<s;o++)n!==o&&r.push(t[o]);return l},parseDefault=function(e,a){let t,r,s,i,n,o={};for(t in a)if(s=a[t],r=e[t],o[t]=s,void 0===r)e[t]=EMPTYARR;else for(n=0,i=r.length;n<i;n++)o[r[n]]=s;return o},parseOptions=function(e,a,t){let r,s,i,n,o,l,_={};if(void 0!==a)for(o=0,i=a.length;o<i;o++)if(r=a[o],s=e[r],_[r]=t,void 0===s)e[r]=EMPTYARR;else for(l=0,n=s.length;l<n;l++)_[s[l]]=t;return _},write=function(e,a,t,r,s){let i,n,o=r[a],l=void 0===o?-1:o.length;if(l>=0||void 0===s||s(a))for(n=e[a],void 0===n?e[a]=t:isArray(n)?n.push(t):e[a]=[n,t],i=0;i<l;i++)e[o[i]]=e[a]},getopts=function(e,a){let t,r,s,i,n,o=(a=a||{}).unknown,l=parseAlias(a.alias),_=parseOptions(l,a.string,""),u=parseDefault(l,a.default),c=parseOptions(l,a.boolean,!1),f=a.stopEarly,p=[],E={_:p},A=0,d=0,S=e.length;for(;A<S;A++)if(r=e[A],"-"!==r[0]||"-"===r)if(f)for(;A<S;)p.push(e[A++]);else p.push(r);else if("--"===r)for(;++A<S;)p.push(e[A]);else if("-"===r[1])s=r.indexOf("=",2),"n"===r[2]&&"o"===r[3]&&"-"===r[4]?(t=r.slice(5,s>=0?s:void 0),n=!1):s>=0?(t=r.slice(2,s),n=void 0!==c[t]||(void 0===_[t]?parseValue(r.slice(s+1)):r.slice(s+1))):(t=r.slice(2),n=void 0!==c[t]||(S===A+1||"-"===e[A+1][0]?void 0===_[t]||"":void 0===_[t]?parseValue(e[++A]):e[++A])),write(E,t,n,l,o);else for(SHORTSPLIT.lastIndex=2,i=SHORTSPLIT.exec(r),s=i.index,n=i[0],d=1;d<s;d++)write(E,t=r[d],d+1<s?void 0===_[t]||r.substring(d+1,d=s)+n:""===n?S===A+1||"-"===e[A+1][0]?void 0===_[t]||"":void 0!==c[t]||(void 0===_[t]?parseValue(e[++A]):e[++A]):void 0!==c[t]||(void 0===_[t]?parseValue(n):n),l,o);for(t in u)void 0===E[t]&&(E[t]=u[t]);for(t in c)void 0===E[t]&&(E[t]=!1);for(t in _)void 0===E[t]&&(E[t]="");return E};var getopts_1=getopts;const $$=e=>`__Symbol@@${e}__`,__QUOTE__=$$("QUOTE"),__APOS__=$$("APOS"),__SPA__=$$("SPA"),RE_CAMEL_CASE=/-(\w)/g,RE_MATCH_KEYVAL=/^((?!\d)[-~+./\w]+)([=:])(.+?)?$/,RE_MATCH_QUOTES=/(["'])(?:(?!\1).)*\1/,RE_SPECIAL_CHARS=['"',"'"," "],RE_ESCAPE_CHARS=[/\\"/g,/\\'/g,/\\ /g],RE_QUOTED_CHARS=[__QUOTE__,__APOS__,__SPA__],RE_UNESCAPE_CHARS=[__QUOTE__,__APOS__,__SPA__].map(e=>new RegExp(e,"g"));function escape(e){return RE_ESCAPE_CHARS.reduce((e,a,t)=>e.replace(a,RE_QUOTED_CHARS[t]),e)}function unescape(e){return RE_UNESCAPE_CHARS.reduce((e,a,t)=>e.replace(a,RE_SPECIAL_CHARS[t]),e)}function unquote(e,a){for(;RE_MATCH_QUOTES.test(e);){const a=e.match(RE_MATCH_QUOTES),t=a[0].substr(1,a[0].length-2);e=e.replace(a[0],RE_SPECIAL_CHARS.reduce((e,a,t)=>e.replace(a,RE_QUOTED_CHARS[t]),t))}if(a)for(;e.indexOf(" ")>-1;)e=RE_SPECIAL_CHARS.reduce((e,a,t)=>e.replace(a,RE_QUOTED_CHARS[t]),e);return e.split(/\s+/)}function evaluate(e,a){return"function"==typeof a?a(e):e}function camelcase(e){return e.replace(RE_CAMEL_CASE,(e,a)=>a.toUpperCase())}function autocamelcase(e,a){if("string"==typeof e){if((a||0===e.indexOf("--"))&&-1===e.indexOf("no-")){if(-1===e.indexOf("="))return a?camelcase(e):`--${camelcase(e.substr(2))}`;let[t,...r]=e.split("=");return t=a?camelcase(t):`--${camelcase(t.substr(2))}`,r=r.length>1?r.join("="):r[0],`${t}=${r}`}return e}return e.map(e=>autocamelcase(e,a))}var lib=(e,a,t)=>{if("function"==typeof(a=a||{})&&(t=a,a={}),a.format&&(t=a.format,delete a.format),!Array.isArray(e)){let a;e=escape(String(e||""));do{a=e.match(RE_MATCH_QUOTES),a&&(e=e.replace(a[0],unquote(a[0],!0)))}while(a);e=e.trim().split(/\s+/).map(unescape).filter(e=>e)}const r=e.indexOf("--"),s=[];r>-1&&(e.slice(r+1).forEach(e=>{s.push(evaluate(e,t))}),e.splice(r+1,e.length)),"string"==typeof a.boolean&&(a.boolean=a.boolean.split("")),"string"==typeof a.string&&(a.string=a.string.split("")),a.boolean&&(a.boolean=autocamelcase(a.boolean,!0)),a.string&&(a.string=autocamelcase(a.string,!0)),a.alias&&Object.keys(a.alias).forEach(e=>{a.alias[e]=autocamelcase(a.alias[e],!0)});const i=getopts_1(autocamelcase(e),a),n=i._.slice();Object.keys(i).forEach(e=>{""===e&&delete i[e],""===i[e]&&(i[e]=null)});const o={},l={};return delete i._,Object.keys(i).forEach(e=>{const r=i[e];-1!==e.indexOf("-")&&(delete i[e],e=camelcase(e)),a.alias&&a.alias[e]&&0===a.alias[e].indexOf("no-")&&(i[a.alias[e]]&&(i[a.alias[e].substr(3)]=!1),i[e]=!0),Array.isArray(r)&&(i[e]=r.map(e=>evaluate(e,t))),"string"==typeof r&&("="===r.charAt()?i[e]=evaluate(r.substr(1),t):i[e]=evaluate(r,t))}),{_:n.reduce((e,a)=>{const r=a.match(RE_MATCH_KEYVAL);return r?"="===r[2]?o[r[1]]=evaluate(r[3]||"",t):l[r[1]]?(Array.isArray(l[r[1]])||(l[r[1]]=[l[r[1]]]),l[r[1]].push(evaluate(r[3]||"",t))):l[r[1]]=evaluate(r[3]||"",t):e.push(evaluate(a,t)),e},[]),raw:s,data:o,flags:i,params:l}};module.exports=lib;
